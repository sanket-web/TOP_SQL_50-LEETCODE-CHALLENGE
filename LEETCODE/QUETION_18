QUETION LINK :-https://leetcode.com/problems/product-sales-analysis-iii/description/?envType=study-plan-v2&envId=top-sql-50

-- LEETCODE QUETION NO. :- 1070. Product Sales Analysis III


Example 1: Write a solution to find all sales that occurred in the first year each product was sold.
           For each product_id, identify the earliest year it appears in the Sales table.
           Return all sales entries for that product in that year.

Input: 
Sales table:
+---------+------------+------+----------+-------+
| sale_id | product_id | year | quantity | price |
+---------+------------+------+----------+-------+ 
| 1       | 100        | 2008 | 10       | 5000  |
| 2       | 100        | 2009 | 12       | 5000  |
| 7       | 200        | 2011 | 15       | 9000  |
+---------+------------+------+----------+-------+

EXPECTED Output: 
+------------+------------+----------+-------+
| product_id | first_year | quantity | price |
+------------+------------+----------+-------+ 
| 100        | 2008       | 10       | 5000  |
| 200        | 2011       | 15       | 9000  |
+------------+------------+----------+-------+




-- QUERY :- 

SELECT product_id ,year AS first_year , quatity ,price
FROM Sales
WHERE (product_id,year) IN
(SELECT product_id, MIN(year)FROM Sales
GROUP BY product_id);

Output: 
+------------+------------+----------+-------+
| product_id | first_year | quantity | price |
+------------+------------+----------+-------+ 
| 100        | 2008       | 10       | 5000  |
| 200        | 2011       | 15       | 9000  |
+------------+------------+----------+-------+
